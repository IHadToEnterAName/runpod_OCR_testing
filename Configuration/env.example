# =============================================================================
# Production RAG System - Environment Configuration
# =============================================================================
# Copy this file to .env and update with your settings

# -----------------------------------------------------------------------------
# SERVICE ENDPOINTS
# -----------------------------------------------------------------------------

# Redis Configuration
REDIS_HOST=redis
REDIS_PORT=6379

# ChromaDB Configuration
CHROMA_HOST=chromadb
CHROMA_PORT=8000

# vLLM Endpoints (running on host)
VISION_URL=http://host.docker.internal:8006/v1
REASONING_URL=http://host.docker.internal:8005/v1

# -----------------------------------------------------------------------------
# MODEL CONFIGURATION
# -----------------------------------------------------------------------------

# Vision Model (for image analysis)
VISION_MODEL=Qwen/Qwen2.5-VL-3B-Instruct
VISION_ENABLED=true

# Reasoning Model (for RAG)
REASONING_MODEL=deepseek-ai/DeepSeek-R1-Distill-Qwen-7B

# Embedding Model (for vector search)
EMBEDDING_MODEL=nomic-ai/nomic-embed-text-v1.5

# -----------------------------------------------------------------------------
# RAG PARAMETERS
# -----------------------------------------------------------------------------

# Retrieval
RETRIEVAL_TOP_K=8
GRADING_THRESHOLD=0.6
MAX_RETRIES=2

# Generation
TEMPERATURE=0.3
MAX_TOKENS=2048

# Chunking
CHUNK_SIZE=800
CHUNK_OVERLAP=100

# -----------------------------------------------------------------------------
# CACHE CONFIGURATION
# -----------------------------------------------------------------------------

# Semantic Cache
CACHE_SIMILARITY_THRESHOLD=0.95
CACHE_TTL_SECONDS=3600
CACHE_MAX_SIZE=10000

# -----------------------------------------------------------------------------
# GPU CONFIGURATION
# -----------------------------------------------------------------------------

# Which GPUs to use (comma-separated)
CUDA_VISIBLE_DEVICES=0

# GPU memory allocation for vLLM (0.0-1.0)
VISION_GPU_MEMORY_UTILIZATION=0.3
REASONING_GPU_MEMORY_UTILIZATION=0.53

# -----------------------------------------------------------------------------
# PATHS
# -----------------------------------------------------------------------------

# Data directories
UPLOAD_DIR=/workspace/data/uploads
PROCESSED_DIR=/workspace/data/processed
FAILED_DIR=/workspace/data/failed

# Model cache
HF_HOME=/workspace/huggingface
TRANSFORMERS_CACHE=/workspace/huggingface

# Vector DB
CHROMA_PERSIST_DIR=/workspace/chroma_db

# -----------------------------------------------------------------------------
# AIRFLOW CONFIGURATION
# -----------------------------------------------------------------------------

# Airflow Database
AIRFLOW__DATABASE__SQL_ALCHEMY_CONN=postgresql+psycopg2://airflow:airflow@airflow_postgres/airflow

# Airflow Security (CHANGE IN PRODUCTION!)
AIRFLOW__CORE__FERNET_KEY=FB0o_zt4e3Ziq3LdUUO7F2Z95cvFFx16hU8jTeR1ASM=
AIRFLOW__WEBSERVER__SECRET_KEY=secret_key_change_in_production

# Airflow Settings
AIRFLOW__CORE__EXECUTOR=LocalExecutor
AIRFLOW__CORE__LOAD_EXAMPLES=False
AIRFLOW__WEBSERVER__EXPOSE_CONFIG=True

# DAG Schedule (cron format)
INGESTION_SCHEDULE=0 2 * * *  # Daily at 2 AM

# -----------------------------------------------------------------------------
# SECURITY (Production Settings)
# -----------------------------------------------------------------------------

# Set these in production!
# AIRFLOW_ADMIN_PASSWORD=change_me
# POSTGRES_PASSWORD=change_me
# REDIS_PASSWORD=change_me

# -----------------------------------------------------------------------------
# LOGGING
# -----------------------------------------------------------------------------

LOG_LEVEL=INFO
AIRFLOW__LOGGING__LOGGING_LEVEL=INFO

# -----------------------------------------------------------------------------
# PERFORMANCE
# -----------------------------------------------------------------------------

# Concurrent limits
VISION_CONCURRENT_LIMIT=1
LLM_CONCURRENT_LIMIT=2
EMBEDDING_BATCH_SIZE=64

# Workers
FILE_PROCESSING_WORKERS=8

# -----------------------------------------------------------------------------
# DEVELOPMENT
# -----------------------------------------------------------------------------

# Enable debug mode (not for production!)
DEBUG=false
RELOAD=false
